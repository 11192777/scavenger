from itertools import groupby

if __name__ == '__main__':
    str = '''voucher	KMH1
voucher	KMMC1
voucher	REF1
voucher	REF2
voucher	REF3
BXYF	KMH1
BXYF	KMMC1
BXYF	REF1
BXYF	REF2
BXYF	REF3
voucher02_QC	KMH1
voucher02_QC	KMMC1
voucher02_QC	REF1
voucher02_QC	REF2
voucher02_QC	REF3
invoice1	AGENCY
invoice1	CLIENT
invoice1	CLIENTCODE
invoice2	AGENCY
invoice2	AGENCYCODE
invoice2	CLIENT
invoice2	CLIENTCODE
invoice2	FORM_CODE
voucher03_QC	REF1
voucher03_QC	REF2
voucher03_QC	REF3
voucher03_QC	KMH1
voucher03_QC	KMMC1
contractQ	BLCODE
contractQ	JXS
contractQ	JXSCODE
contractJ	CLIENT
contractJ	CLIENTCODE
voucher07_QC	REF1
voucher07_QC	REF2
voucher07_QC	REF3
voucher07_QC	KMH1
voucher07_QC	KMMC1
voucher01_QC	KMH1
voucher01_QC	KMMC1
voucher01_QC	REF1
voucher01_QC	REF2
voucher01_QC	REF3
DFSRQR	KMH1
DFSRQR	KMMC1
DFSRQR	REF1
DFSRQR	REF2
DFSRQR	REF3
workflow_QC01	RENTDATE
workflow_QC01	CLIENTCODE
workflow_QC01	CLIENT
workflow_QC01	JXS
workflow_QC01	JXSCODE
workflow_QC01	BLCODE
workflow_QC01	FORM_CODE
workflow_QC01	VATOUTPUT_NO
workflow_QC01	VAT_NO
workflow_QC02	RENTDATE
workflow_QC02	CLIENT
workflow_QC02	CLIENTCODE
workflow_QC02	JXS
workflow_QC02	JXSCODE
workflow_QC02	BLCODE
workflow_QC02	VAT_NO
workflow_QC04	GL_CODE_ARRAY
workflow_QC04	RENTDATE
workflow_QC04	CLIENT
workflow_QC04	CLIENTCODE
workflow_QC04	JXSCODE
workflow_QC04	JXS
workflow_QC04	BLCODE
workflow_QC04	SK_CODE
workflow_QC04	INCOMEID
workflow_QC04	RECEIPT_NOARRY
workflow_QC05	BLCODE
workflow_QC05	JXS
workflow_QC05	JXSCODE
workflow_QC05	FORM_CODE
workflow_QC05	VATOUTPUT_NO
workflow_QC03	CLIENT
workflow_QC03	CLIENTCODE
workflow_QC03	JXS
workflow_QC03	JXSCODE
workflow_QC03	RENTDATE
workflow_QC06	RENTDATE
workflow_QC06	CLIENTCODE
workflow_QC06	CLIENT
workflow_QC06	JXS
workflow_QC06	JXSCODE
workflow_QC06	SK_CODE
workflow_QC06	INCOMEID
workflow_QC06	CONTRACT_NUMBER
workflow_QC07	RENTDATE
workflow_QC07	CLIENTCODE
workflow_QC07	CLIENT
workflow_QC07	JXS
workflow_QC07	JXSCODE
workflow_QC08	SK_CODE
workflow_QC08	INCOMEID
workflow_QC08	BLCODE
workflow_QC08	JXS
workflow_QC08	JXSCODE
workflow_JJ01	CLIENT
workflow_JJ01	CLIENTCODE
workflow_JJ01	AGENCY
workflow_JJ01	AGENCYCODE
workflow_JJ01	ZLW
workflow_JJ02	CLIENT
workflow_JJ02	CLIENTCODE
workflow_JJ02	AGENCY
workflow_JJ02	AGENCYCODE
workflow_JJ02	ZLW
workflow_JJ02	VAT_NO
workflow_JJ02	VAT_CODE
workflow_JJ02	SKF_NAME
workflow_JJ02	VAT_AMOUNT
workflow_JJ02	VATOUTPUT_AMOUNT
workflow_JJ03	CLIENT
workflow_JJ03	AGENCY
workflow_JJ03	CLIENTCODE
workflow_JJ03	AGENCYCODE
workflow_JJ03	ZLW
workflow_JJ04	CLIENTCODE
workflow_JJ04	AGENCY
workflow_JJ04	AGENCYCODE
workflow_JJ04	CLIENT
workflow_JJ04	ZLW
workflow_JJ04	VATOUTPUT_AMOUNT
workflow_JJ04	VATOUTPUT_NO
workflow_JJ04	VATOUTPUT_CODE
workflow_JJ04	FORM_CODE
workflow_JJ05	CLIENTCODE
workflow_JJ05	CLIENT
workflow_JJ05	AGENCY
workflow_JJ05	AGENCYCODE
workflow_JJ05	ZLW
workflow_JJ06	CLIENTCODE
workflow_JJ06	CLIENT
workflow_JJ06	AGENCY
workflow_JJ06	AGENCYCODE
workflow_JJ06	ZLW
workflow_JJ07	GL_CODE_ARRAY
workflow_JJ07	BLCODE
workflow_JJ07	CONTRACT_NUMBER
QZVoucher	KMH1
QZVoucher	KMMC1
QZVoucher	REF1
QZVoucher	REF2
QZVoucher	REF3
voucher_addQC	BLJH
voucher_addQC	CNAME1
voucher_addQC	CCODE1
voucher_addQC	JXS1
voucher_addQC	JXSCODE1
voucher_addQC	JXS
voucher_addQC	JXSCODE
voucher_addJJ	DLD
voucher_addJJ	DLDCODE
voucher_addJJ	BLJH
voucher_addJJ	CNAME1
voucher_addJJ	CCODE1
voucher_addJJ	CONTRACTV1
CFPAY	KMH1
CFPAY	KMMC1
CFPAY	REF1
CFPAY	REF2
CFPAY	REF3
CFYW	REF1
CFYW	REF2
CFYW	REF3
CFYW	KMH1
CFYW	KMMC1
CFPAYABLE	REF1
CFPAYABLE	REF2
CFPAYABLE	REF3
CFPAYABLE	KMH1
CFPAYABLE	KMMC1
CFPAY2	REF1
CFPAY2	REF2
CFPAY2	REF3
CFPAY2	KMH1
CFPAY2	KMMC1
TXXI	REF1
TXXI	REF2
TXXI	REF3
TXXI	KMH1
TXXI	KMMC1
TXSK	REF1
TXSK	REF2
TXSK	REF3
TXSK	KMH1
TXSK	KMMC1
ZJRJ	REF1
ZJRJ	REF2
ZJRJ	REF3
ZJRJ	KMH1
ZJRJ	KMMC1
ZJHX	REF1
ZJHX	REF2
ZJHX	REF3
ZJHX	KMH1
ZJHX	KMMC1
SRQR	REF1
SRQR	REF2
SRQR	REF3
SRQR	KMH1
SRQR	KMMC1
XXSQR	REF1
XXSQR	REF2
XXSQR	REF3
XXSQR	KMH1
XXSQR	KMMC1
JGFYT	REF1
JGFYT	REF2
JGFYT	REF3
JGFYT	KMH1
JGFYT	KMMC1
JGFYF	REF1
JGFYF	REF2
JGFYF	REF3
JGFYF	KMH1
JGFYF	KMMC1
JGFZF	REF1
JGFZF	REF2
JGFZF	REF3
JGFZF	KMH1
JGFZF	KMMC1
DFBZJ	REF1
DFBZJ	REF2
DFBZJ	REF3
DFBZJ	KMH1
DFBZJ	KMMC1
DFSFKHX	REF1
DFSFKHX	REF2
DFSFKHX	REF3
DFSFKHX	KMH1
DFSFKHX	KMMC1
DFBLYF	KMH1
DFBLYF	KMMC1
DFBLYF	REF1
DFBLYF	REF2
DFBLYF	REF3
DFBLZF	REF1
DFBLZF	REF2
DFBLZF	REF3
DFBLZF	KMH1
DFBLZF	KMMC1
DFRJ	REF1
DFRJ	REF2
DFRJ	REF3
DFRJ	KMH1
DFRJ	KMMC1
DFSJ	REF1
DFSJ	REF2
DFSJ	REF3
DFSJ	KMH1
DFSJ	KMMC1
RJPZ	REF1
RJPZ	REF2
RJPZ	REF3
RJPZ	KMH1
RJPZ	KMMC1
HXPZ	REF1
HXPZ	REF2
HXPZ	REF3
HXPZ	KMH1
HXPZ	KMMC1
TKYF	REF1
TKYF	REF2
TKYF	REF3
TKYF	KMH1
TKYF	KMMC1
TKZF	REF1
TKZF	REF2
TKZF	REF3
TKZF	KMH1
TKZF	KMMC1
DFGLFRJ	REF1
DFGLFRJ	REF2
DFGLFRJ	REF3
DFGLFRJ	KMH1
DFGLFRJ	KMMC1
BXZF	REF1
BXZF	REF2
BXZF	REF3
BXZF	BLJH
BXZF	CNAME1
BXZF	CCODE1
BXZF	CONTRACTV1
BXZF	JXS1
BXZF	JXSCODE1
BXZF	KMH1
BXZF	KMMC1
YTPZ	REF1
YTPZ	REF2
YTPZ	KMH1
YTPZ	KMMC1
receiptD	BLCODE
receiptD	CLIENT
receiptD	AGENCY
receiptD	AGENCYCODE
DGYF	REF1
DGYF	REF2
DGYF	REF3
DGYF	KMH1
DGYF	KMMC1
voucher04_QC	REF1
voucher04_QC	REF2
voucher04_QC	REF3
voucher04_QC	KMH1
voucher04_QC	KMMC1
voucher05_QC	REF1
voucher05_QC	REF2
voucher05_QC	REF3
voucher05_QC	KMH1
voucher05_QC	KMMC1
voucher06_QC	REF1
voucher06_QC	REF2
voucher06_QC	REF3
voucher06_QC	KMH1
voucher06_QC	KMMC1
voucher08_QC	REF1
voucher08_QC	REF2
voucher08_QC	REF3
voucher08_QC	KMH1
voucher08_QC	KMMC1
voucher01_JJ	REF1
voucher01_JJ	REF2
voucher01_JJ	REF3
voucher01_JJ	KMH1
voucher01_JJ	KMMC1
voucher02_JJ	REF1
voucher02_JJ	REF2
voucher02_JJ	REF3
voucher02_JJ	KMH1
voucher02_JJ	KMMC1
voucher03_JJ	REF1
voucher03_JJ	REF2
voucher03_JJ	REF3
voucher03_JJ	KMH1
voucher03_JJ	KMMC1
voucher04_JJ	REF1
voucher04_JJ	REF2
voucher04_JJ	REF3
voucher04_JJ	KMH1
voucher04_JJ	KMMC1
voucher05_JJ	REF1
voucher05_JJ	REF2
voucher05_JJ	REF3
voucher05_JJ	KMH1
voucher05_JJ	KMMC1
voucher07_JJ	REF1
voucher07_JJ	REF2
voucher07_JJ	REF3
voucher07_JJ	KMH1
voucher07_JJ	KMMC1
voucher08_JJ	REF1
voucher08_JJ	REF2
voucher08_JJ	REF3
voucher08_JJ	KMH1
voucher08_JJ	KMMC1
voucher09_JJ	REF1
voucher09_JJ	REF2
voucher09_JJ	REF3
voucher09_JJ	KMH1
voucher09_JJ	KMMC1
voucher10_JJ	REF1
voucher10_JJ	REF2
voucher10_JJ	REF3
voucher10_JJ	KMH1
voucher10_JJ	KMMC1
voucher11_JJ	REF1
voucher11_JJ	REF2
voucher11_JJ	REF3
voucher11_JJ	KMH1
voucher11_JJ	KMMC1
voucher12_JJ	REF1
voucher12_JJ	REF2
voucher12_JJ	REF3
voucher12_JJ	KMH1
voucher12_JJ	KMMC1
voucher13_JJ	REF1
voucher13_JJ	REF2
voucher13_JJ	REF3
voucher13_JJ	KMH1
voucher13_JJ	KMMC1
voucher14_JJ	REF1
voucher14_JJ	REF2
voucher14_JJ	REF3
voucher14_JJ	KMH1
voucher14_JJ	KMMC1
voucher15_JJ	REF1
voucher15_JJ	REF2
voucher15_JJ	REF3
voucher15_JJ	KMH1
voucher15_JJ	KMMC1
voucher16_JJ	REF1
voucher16_JJ	REF2
voucher16_JJ	REF3
voucher16_JJ	KMH1
voucher16_JJ	KMMC1
voucher18_JJ	REF1
voucher18_JJ	REF2
voucher18_JJ	REF3
voucher18_JJ	KMH1
voucher18_JJ	KMMC1'''
    items = [{"form": line.split()[0], "field": line.split()[1]} for line in str.splitlines()]
    res = groupby(items, key=lambda x: (x["form"]))
    for k, v in res:
        sql = '''UPDATE
    ea_form                     ef
    INNER JOIN ea_form_field    eff ON ef.id = eff.form_id
SET
    eff.last_modified_by     = '-20230506',
    eff.widget_type_property = '{{"ITEM_WORDS_LIMIT":"100","ITEMS_LIMIT":"500","MAX_ITEMS_LIMIT":"500"}}'
WHERE
    ef.is_deleted = 0 AND eff.is_deleted = 0 AND ef.tenant_id = '1369119428719050753'
    AND eff.widget_type = 'TEXT_ARRAY'
    AND ef.code IN ('{}')
    AND eff.code IN ({});
'''
        print(sql.format(k, ','.join(["'{}'".format(item["field"]) for item in v])))
